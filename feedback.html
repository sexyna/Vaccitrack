<script>
  if (localStorage.getItem("loggedIn") !== "true") {
    window.location.href = "login.html";
  }
</script>


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Secure Feedback - VacciTrack</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    .animate-fade-in { animation: fade-in 1s ease-out; }
    .emoji { font-size: 2rem; cursor: pointer; transition: transform 0.2s; }
    .emoji:hover { transform: scale(1.3); }
    .selected { border: 2px solid #3b82f6; border-radius: 8px; padding: 5px; }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col">

  <!-- Background Video -->
  <video autoplay muted loop playsinline class="fixed top-0 left-0 w-full h-full object-cover z-[-1]">
    <source src="vid.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

  <!-- Navbar -->
  <header class="flex justify-between items-center p-6">
    <div class="text-xl font-bold">VacciTrack</div>
    <nav class="space-x-6">
      <a href="index.html" class="text-white hover:text-blue-400 transition">Home</a>
      <a href="statistics.html" class="text-white hover:text-blue-400 transition">Statistics</a>
      <a href="vaccine.html" class="text-white hover:text-blue-400 transition">Vaccine</a>
      <a href="securefeedback.html" class="relative text-white hover:text-blue-400 hover:scale-110 transition-all duration-200">Secure Feedback</a>
    </nav>
  </header>

  <!-- Main Feedback Form -->
  <main class="flex-grow px-6 md:px-20 py-16 flex items-center justify-center">
    <div class="max-w-lg w-full bg-gray-800 p-8 rounded-xl shadow-xl animate-fade-in">
      <h1 class="text-3xl font-bold mb-6 text-center">💬 Secure Feedback</h1>

      <!-- Category Buttons -->
      <div class="flex flex-wrap gap-2 mb-4">
        <button onclick="setCategory('Website')" class="px-3 py-1 bg-gray-700 hover:bg-blue-600 rounded-full">Website</button>
        <button onclick="setCategory('Vaccination Info')" class="px-3 py-1 bg-gray-700 hover:bg-blue-600 rounded-full">Vaccination Info</button>
        <button onclick="setCategory('UI Suggestions')" class="px-3 py-1 bg-gray-700 hover:bg-blue-600 rounded-full">UI Suggestions</button>
      </div>

      <!-- Emoji Rating -->
      <div class="flex justify-center gap-4 mb-4">
        <span class="emoji" onclick="selectEmoji(this)">😡</span>
        <span class="emoji" onclick="selectEmoji(this)">😕</span>
        <span class="emoji" onclick="selectEmoji(this)">😐</span>
        <span class="emoji" onclick="selectEmoji(this)">😊</span>
        <span class="emoji" onclick="selectEmoji(this)">😍</span>
      </div>

      <!-- Feedback Text -->
      <textarea id="feedbackText" placeholder="Write your feedback here..." 
        class="w-full p-3 rounded-lg bg-gray-700 text-white focus:outline-none" rows="5"
        oninput="updateWordCount()"></textarea>
      <p id="wordCount" class="text-sm text-gray-400 mt-1">0 words</p>

      <!-- Preview -->
      <div class="mt-4 p-3 bg-gray-700 rounded-lg text-sm text-gray-300 hidden" id="previewBox"></div>

      <!-- Submit Button -->
      <button onclick="submitFeedback()" 
        class="w-full mt-4 bg-blue-600 hover:bg-blue-700 py-2 rounded-lg transition-all duration-200 hover:scale-105">
        Submit Feedback
      </button>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 px-6 md:px-20 py-6 border-t border-gray-700 text-gray-500 text-center">
    © 2025 VacciTrack
  </footer>

  <script>
    let category = "";
    let selectedEmoji = "";
    let userID = localStorage.getItem("anonID") || generateAnonID();

    function generateAnonID() {
      let id = "user_" + Math.random().toString(36).substring(2, 10);
      localStorage.setItem("anonID", id);
      return id;
    }

    function setCategory(cat) {
      category = cat;
      alert(`Category selected: ${cat}`);
    }

    function selectEmoji(el) {
      document.querySelectorAll('.emoji').forEach(e => e.classList.remove('selected'));
      el.classList.add('selected');
      selectedEmoji = el.textContent;
    }

    function updateWordCount() {
      const text = document.getElementById("feedbackText").value;
      document.getElementById("wordCount").textContent = text.trim().split(/\s+/).filter(w => w).length + " words";
      document.getElementById("previewBox").classList.remove("hidden");
      document.getElementById("previewBox").textContent = "Preview: " + text;
    }

    function submitFeedback() {
      const text = document.getElementById("feedbackText").value.trim();
      if (!text) {
        alert("Please enter feedback before submitting.");
        return;
      }
      alert(`✅ Feedback sent anonymously!\nUser ID: ${userID}\nCategory: ${category}\nEmoji: ${selectedEmoji}\nMessage: ${text}`);
      document.getElementById("feedbackText").value = "";
      document.getElementById("previewBox").classList.add("hidden");
      document.getElementById("wordCount").textContent = "0 words";
      document.querySelectorAll('.emoji').forEach(e => e.classList.remove('selected'));
    }
  </script>
</body>
</html>
